---
import { string } from "astro:schema";
import LanguageSwitcher from "./LanguageSwitcher.astro";

const logoSize = (times = 1) => {
  const w = 115;
  const h = 48;
  return { width: w * times, height: h * times };
};

const currentLocale = Astro.currentLocale || "it";
const baseUrl = currentLocale === "en" ? "/en" : "";

const url: Record<string, string> = {
  homepage: `${baseUrl}/`,
  graphicDesigner: `${baseUrl}/graphic-designer`,
  contentCreator: `${baseUrl}/content-creator`,
  socialMediaManager: `${baseUrl}/social-media-manager`,
};

// Importa le traduzioni
const translations = await import(`../i18n/${currentLocale}.json`);
const t = translations.default;
---

<div class="navbar-container">
  <div class="upper">
    <a href={url.homepage}
      ><img
        src="/logo.svg"
        width={logoSize().width}
        height={logoSize().height}
        alt="Studio Mua Homepage"
      /></a
    >
  </div>
  <button class="burger-menu" id="burgerMenu" aria-label="Toggle menu">
    <span></span>
    <span></span>
    <span></span>
  </button>
  <div class="links-container" id="navLinks">
    <a class="nav-item" href={url.homepage} data-page="homepage"
      ><button>{t.nav.home}</button></a
    >
    <a class="nav-item" href={url.graphicDesigner} data-page="graphic-designer">
      <button>{t.nav.graphicDesigner}</button></a
    >
    <a class="nav-item" href={url.contentCreator} data-page="content-creator">
      <button>{t.nav.contentCreator}</button></a
    >
    <a
      class="nav-item"
      href={url.socialMediaManager}
      data-page="social-media-manager"
    >
      <button>{t.nav.socialMediaManager}</button></a
    >
    <div class="language-switcher-nav">
      <LanguageSwitcher />
    </div>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const burgerMenu = document.getElementById("burgerMenu");
    const navLinks = document.getElementById("navLinks");

    burgerMenu?.addEventListener("click", () => {
      burgerMenu.classList.toggle("active");
      navLinks?.classList.toggle("active");
    });

    // Evidenzia la voce di menu della pagina corrente
    const currentPath = window.location.pathname;
    const navItems = document.querySelectorAll(".nav-item");

    navItems.forEach((item) => {
      const href = item.getAttribute("href");
      if (href && currentPath === href) {
        item.classList.add("active-page");
      }
    });
  });
</script>

<style>
  .navbar-container {
    background-color: var(--white);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 3px 0;
    border-bottom: 1px solid #e0e0e0;
    color: var(--brown);
    position: sticky;
    top: 0;
    z-index: 1000;
    width: 100%;
    border-top: 10px solid var(--blue);
  }

  .links-container {
    display: flex;
    justify-content: center;
    align-items: center;
    width: 100%;
  }

  .nav-item {
    color: var(--brown);
    text-decoration: none;
    margin: 0 15px;
    font-weight: bold;
    padding: 8px 12px;
    border-radius: 4px;
    transition:
      background-color 0.3s,
      color 0.3s,
      transform 0.2s;
  }

  .nav-item:hover {
    background-color: rgba(255, 255, 255, 0.15);
    transform: translateY(-2px);
  }

  .nav-item:active {
    background-color: rgba(255, 255, 255, 0.25);
    transform: translateY(0);
  }

  .nav-item.active-page {
    /* background-color: rgba(255, 255, 255, 0.3); */
    border-bottom: 3px solid var(--brown);
  }

  .nav-item.active-page button {
    font-weight: 900;
  }

  .links-container button {
    background: none;
    border: none;
    color: var(--brown);
    font-size: 1rem;
    cursor: pointer;
    transition: all 0.3s;
  }

  .nav-item:hover button {
    color: var(--brown);
    text-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
  }

  .nav-item:active button {
    transform: scale(0.98);
  }

  .language-switcher-nav {
    margin-left: 20px;
    padding-left: 20px;
    border-left: 1px solid rgba(255, 255, 255, 0.3);
  }

  .burger-menu {
    display: none;
    flex-direction: column;
    justify-content: space-around;
    width: 35px;
    height: 30px;
    background: transparent;
    border: none;
    cursor: pointer;
    padding: 5px;
    z-index: 1001;
    position: absolute;
    right: 40px;
  }

  .burger-menu span {
    width: 30px;
    height: 3px;
    background-color: var(--brown);
    border-radius: 2px;
    transition: all 0.3s ease;
  }

  .burger-menu.active span:nth-child(1) {
    transform: rotate(45deg) translate(8px, 8px);
  }

  .burger-menu.active span:nth-child(2) {
    opacity: 0;
  }

  .burger-menu.active span:nth-child(3) {
    transform: rotate(-45deg) translate(8px, -8px);
  }

  @media (max-width: 720px) {
    .navbar-container {
      justify-content: space-between;
      padding: 10px 15px;
    }

    .upper {
      z-index: 1002;
    }

    .burger-menu {
      display: flex;
      right: 40px;
    }

    .links-container {
      position: fixed;
      top: 60px;
      right: -100%;
      width: 250px;
      height: calc(100vh - 60px);
      background-color: var(--white);
      flex-direction: column;
      justify-content: flex-start;
      align-items: flex-start;
      padding: 20px;
      transition: right 0.3s ease;
      box-shadow: -2px 0 5px rgba(0, 0, 0, 0.1);
    }

    .links-container.active {
      right: 0;
    }

    .nav-item {
      margin: 10px 0;
      width: 100%;
    }

    .links-container button {
      text-align: left;
      width: 100%;
      padding: 10px;
    }

    .language-switcher-nav {
      margin-left: 0;
      margin-top: 20px;
      padding-left: 0;
      padding-top: 20px;
      border-left: none;
      border-top: 1px solid rgba(255, 255, 255, 0.3);
      width: 100%;
    }
  }
</style>
